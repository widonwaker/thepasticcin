<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
    <script type="text/javascript" charset="utf-8" src="cordova.js"></script>  
	<title>I Pasticcini</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script>
	// DA RIMUOVERE
	//localStorage.setItem("deflang","ita");
	</script>
</head>
<body>
<div id="game">

<img class="fabbrica" src="img/edifici/fabbrica5.png" onClick="FactoryUpgrade()"/>
<img class="alloggi" src="img/edifici/alloggi5.png" onClick=""/>
<!--<img class="trasporti" src="img/edifici/trasporto5.png" onClick=""/>-->

<div class="moneybar">
   <img class="top-left-bar" src="img/money_base.png" />
   <img class="top-left-bar" src="img/money_inside.png" />
   <img class="empty" src="img/empty.png" />
   <div class="moneyscore brown" id="score">0</div>
</div>

</div>

<div id="factory-upgrade" class="panel" style="display:none;">
    <img id="alloggi-rib" class="ribbon" />
    <div class="container">
       <div class="title brown">Coins</div>
       <div class="desc">25% more qwefqwev</div>
       <img class="skills" src="img/panel/skills_0.png" />
    </div>
</div>
<!--<a onclick="canc()">cancella</a>-->
<script>
function test() {
	localStorage.setItem("money_save",start);
	console.log(localStorage.getItem("money_save"));
}
function canc() {
	localStorage.removeItem("money_save");
}

var start = (localStorage.getItem("money_save")!==null) ? parseInt(localStorage.getItem("money_save")) : 1;
var speed = 1000;
$(document).ready(function () {
	if (start < 10) {
    go();
    setInterval(function () {
        go();
    }, speed);
	}
});
function go() {
	if (start>9) $('.moneyscore').css("right", "1%");
	if (start>99) $('.moneyscore').css("right", "-1%");
	if (start>999) $('.moneyscore').css("right", "-4%");
	if (start>9999) $('.moneyscore').css("right", "-7%");
	if (start>99999) $('.moneyscore').css("right", "-10%");
	if (start>999999) $('.moneyscore').css("right", "-13%");
	if (start>9999999) $('.moneyscore').css("right", "-16%");
	if (start>99999999) $('.moneyscore').css("right", "-19%");
	if (start>999999999) $('.moneyscore').css("right", "-25%");
    $("#score").html(start.toLocaleString());
    start += 1;
}
</script>

<!--<p style="font-family: 'Carter One', cursive; font-size: 48px; -webkit-text-stroke: 2px green;">TEST</p>
<p style="font-family: 'Skranji', cursive; font-size: 48px">TEST</p>
<p style="font-family: 'Averia Sans Libre', cursive; font-size: 48px">TEST</p>-->

<script>
document.addEventListener("deviceready", onDeviceReady, false);
function onDeviceReady() {
	document.addEventListener("pause", onPause, false);	
	flexFont();
}

function onPause() {
	localStorage.setItem("money_save",start);
}
document.onunload = function () {
	localStorage.setItem("money_save",start);
}
</script>

<script>
var src = 'js/' + localStorage.getItem("deflang") + '.js';
var script = jQuery('<script/>').attr('src', src).appendTo('head');
</script>

<script>
function fontSize () {
    var divs = document.getElementsByClassName("moneybar");
    for(var i = 0; i < divs.length; i++) {
        var relFontsize = divs[i].offsetWidth*0.09;
        divs[i].style.fontSize = relFontsize+'px';
	}
		
	var divs = document.getElementsByClassName("title");
    for(var i = 0; i < divs.length; i++) {
        var relFontsize = divs[i].offsetHeight*1.09;
        divs[i].style.fontSize = relFontsize+'px';	
    }
	
	var divs = document.getElementsByClassName("desc");
    for(var i = 0; i < divs.length; i++) {
        var relFontsize = divs[i].offsetHeight*1.09;
        divs[i].style.fontSize = relFontsize+'px';	
    }
};

window.onload = function(event) {
    fontSize();
};
window.onresize = function(event) {
    fontSize();
};

function FactoryUpgrade() {
	$("#factory-upgrade").show();
	fontSize();
	loadRibbon();
}
</script>
</body>
</html>
